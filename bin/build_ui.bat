@ECHO OFF
@TITLE Build Spine Toolbox GUI

ECHO.
ECHO ^<Script for Building Spine Toolbox GUI^>
ECHO Copyright (C) ^<2017-2019^>  ^<Spine project consortium^>
ECHO This program comes with ABSOLUTELY NO WARRANTY; for details see 'about'.
ECHO box in the application. This is free software, and you are welcome to
ECHO redistribute it under certain conditions; See files COPYING and
ECHO COPYING.LESSER for details.
ECHO.

PAUSE

ECHO --- pyside2-uic version ---
CALL pyside2-uic --version
ECHO --- pyside2-rcc version ---
CALL pyside2-rcc -version
ECHO.
ECHO --- Building Spine Toolbox GUI ---
FOR %%f IN (..\spinetoolbox\ui\*.ui) DO (
    ECHO building %%~nf.py
    CALL pyside2-uic -o ../spinetoolbox/ui/%%~nf.py.o %%f
    findstr /V /C:"# Created:" /C:"#      by:" ..\spinetoolbox\ui\%%~nf.py.o > ..\spinetoolbox\ui\%%~nf.py
    DEL ..\spinetoolbox\ui\%%~nf.py.o > NUL
)
FOR %%f IN (..\spinetoolbox\ui\resources\*.qrc) DO (
    ECHO building %%~nf_rc.py
    CALL pyside2-rcc -o ../spinetoolbox/ui/%%~nf_rc.py %%f
)
ECHO --- Build completed ---
ECHO.
ECHO --- APPENDING LICENSE TO .UI FILES ---
FOR %%f IN (..\spinetoolbox\ui\*.ui) DO (
    CALL append_license_xml %%f
)
ECHO.
ECHO --- APPENDING LICENSE TO AUTOGENERATED .PY FILES ---
FOR %%f IN (..\spinetoolbox\ui\*.py) DO (
    IF NOT "%%~nf" == "__init__" CALL append_license_py %%f
)
